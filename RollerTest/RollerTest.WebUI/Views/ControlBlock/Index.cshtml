@model RollerTest.WebUI.Models.ControlBlockViewModel
@{
    ViewBag.Title = "Index";
}
<div class="row wrapper border-bottom white-bg page-heading">
    <div class="col-lg-10">
        <h2>控制面板</h2>
        <ol class="breadcrumb">
            <li>
                <a href="@Url.Action("Index", "Home")">主页</a>
            </li>
            <li>
                <a>控制面板</a>
            </li>
            <li class="active">
                <strong>控制参数</strong>
            </li>
        </ol>
    </div>
    <div class="col-lg-2">

    </div>
</div>
<div class="row wrapper wrapper-content animated fadeInRight">
    <div class="col-lg-4">
        <div class="col-lg-12 ibox float-e-margins">
            <div class="ibox-title">
                <h5>写入与计时服务</h5>
            </div>
            <div class="ibox-content">
                <div>
                    <div class="feed-activity-list">
                        <div class="feed-element">
                            <div class="media-body ">
                                <strong>写入状态：</strong> @ViewData["FileTimerState"]
                                <div class="pull-right">
                                    <a href="~/ControlBlock/FileOpenTimer"><input type="button" class="btn btn-xs btn-white fa fa-thumbs-up" value="开启" /></a>
                                    <a href="~/ControlBlock/FileCloseTimer"><input type="button" class="btn btn-xs btn-white fa fa-thumbs-up" value="关闭" /></a>
                                </div>
                            </div>
                        </div>
                        <div class="feed-element">
                            <div class="media-body ">
                                <strong>计时状态：</strong> @ViewData["TimerTimerState"] 
                                <div class="pull-right">
                                    <a href="~/ControlBlock/TimerOpenTimer"><input type="button" class="btn btn-xs btn-white fa fa-thumbs-up" value="开启" /></a>
                                    <a href="~/ControlBlock/TimerCloseTimer"><input type="button" class="btn btn-xs btn-white fa fa-thumbs-up" value="关闭" /></a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-12 ibox float-e-margins">
            <div class="ibox-title">
                <h5>电机控制服务</h5>
                <span class="label label-primary pull-right">@ViewData["CdioInitState"]</span>
            </div>
            <div class="ibox-content">
                <div>
                    <div class="feed-activity-list">
                        <div class="feed-element">
                            <div class="media-body ">
                                <strong>监视状态：</strong> @ViewData["CdioTimerState"]<br>
                                <small class="text-muted">点击开启后，实时监控电机状态。</small>
                                <div class="pull-right">
                                    <a href="~/ControlBlock/CdioOpenTimer"><input type="button" class="btn btn-xs btn-white fa fa-thumbs-up" value="开启" /></a>
                                    <a href="~/ControlBlock/CdioCloseTimer"><input type="button" class="btn btn-xs btn-white fa fa-thumbs-up" value="关闭" /></a>
                                </div>
                            </div>
                        </div>
                        <div class="feed-element">
                            <div class="media-body ">
                                <strong>操作提示</strong>
                                <small class="text-muted">点击控制电机运行状态</small>
                                <div class="pull-right">
                                    <a href="~/ControlBlock/MotoRunning"><input type="button" class="btn btn-xs btn-white fa fa-thumbs-up" value="正转" /></a>
                                    <a href="~/ControlBlock/MotoRunningREV"><input type="button" class="btn btn-xs btn-white fa fa-thumbs-up" value="反转" /></a>
                                    <a href="~/ControlBlock/MotoStopping"><input type="button" class="btn btn-xs btn-white fa fa-thumbs-up" value="停止" /></a>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-12 ibox float-e-margins">
            <div class="ibox-title">
                <h5>应力控制服务</h5>
                <span class="label label-primary pull-right">@ViewData["DealState"]</span>
            </div>
            <div class="ibox-content">
                <div>
                    <div class="feed-activity-list">
                        <div class="feed-element">
                            <div class="media-body ">
                                <strong>操作提示</strong>
                                <small class="text-muted">点击控制应力采集状态</small>
                                <div class="pull-right">
                                    <a href="~/ControlBlock/ConnectDeal"><input type="button" class="btn btn-xs btn-white fa fa-thumbs-up" value="连接" /></a>
                                    <a href="~/ControlBlock/CancelDeal"><input type="button" class="btn btn-xs btn-white fa fa-thumbs-up" value="断开" /></a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-lg-8">
        <div class="ibox float-e-margins">
            <div class="ibox-title">
                <h5>资源数据</h5>
            </div>
            <div class="ibox-content">
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <td align="center">编号</td>
                            <td align="center">工位</td>
                            <td align="center">后台计时</td>
                            <td align="center">实时计时</td>
                            <td align="center">实时应力</td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td width="10%">1</td><td width="20%">1#工位</td><td width="25%">@Model.readiniModel.TestTime1</td><td width="25%" id="time-1#"></td><td width="20%" id="data-1#"></td></tr>
                        <tr><td width="10%">2</td><td width="20%">2#工位</td><td width="25%">@Model.readiniModel.TestTime2</td><td width="25%" id="time-2#"></td><td width="20%" id="data-2#"></td></tr>
                        <tr><td width="10%">3</td><td width="20%">3#工位</td><td width="25%">@Model.readiniModel.TestTime3</td><td width="25%" id="time-3#"></td><td width="20%" id="data-3#"></td></tr>
                        <tr><td width="10%">4</td><td width="20%">4#工位</td><td width="25%">@Model.readiniModel.TestTime4</td><td width="25%" id="time-4#"></td><td width="20%" id="data-4#"></td></tr>
                        <tr><td width="10%">5</td><td width="20%">5#工位</td><td width="25%">@Model.readiniModel.TestTime5</td><td width="25%" id="time-5#"></td><td width="20%" id="data-5#"></td></tr>
                        <tr><td width="10%">6</td><td width="20%">6#工位</td><td width="25%">@Model.readiniModel.TestTime6</td><td width="25%" id="time-6#"></td><td width="20%" id="data-6#"></td></tr>
                        <tr><td width="10%">7</td><td width="20%">7#工位</td><td width="25%">@Model.readiniModel.TestTime7</td><td width="25%" id="time-7#"></td><td width="20%" id="data-7#"></td></tr>
                        <tr><td width="10%">8</td><td width="20%">8#工位</td><td width="25%">@Model.readiniModel.TestTime8</td><td width="25%" id="time-8#"></td><td width="20%" id="data-8#"></td></tr>
                        <tr><td width="10%">9</td><td width="20%">9#工位</td><td width="25%">@Model.readiniModel.TestTime9</td><td width="25%" id="time-9#"></td><td width="20%" id="data-9#"></td></tr>
                        <tr><td width="10%">10</td><td width="20%">10#工位</td><td width="25%">@Model.readiniModel.TestTime10</td><td width="25%" id="time-10#"></td><td width="20%" id="data-10#"></td></tr>
                        <tr><td width="10%">11</td><td width="20%">11#工位</td><td width="25%">@Model.readiniModel.TestTime11</td><td width="25%" id="time-11#"></td><td width="20%" id="data-11#"></td></tr>
                        <tr><td width="10%">12</td><td width="20%">12#工位</td><td width="25%">@Model.readiniModel.TestTime12</td><td width="25%" id="time-12#"></td><td width="20%" id="data-12#"></td></tr>
                    </tbody>
                </table>
                <div>
                    <a href="~/ControlBlock/OpenTimePort"><input type="button" class="btn btn-xs btn-white" value="开启计时端口" /></a>
                    <a href="~/ControlBlock/CloseTimePort"><input type="button" class="btn btn-xs btn-white" value="关闭计时端口" /></a>
                    <a href="~/ControlBlock/OpenForcePort"><input type="button" class="btn btn-xs btn-white" value="开启应力端口" /></a>
                    <a href="~/ControlBlock/CloseForcePort"><input type="button" class="btn btn-xs btn-white" value="关闭应力端口" /></a>
                </div>
            </div>
        </div>


    </div>

 </div>



@section scripts{
    <script src="~/Scripts/jquery.signalR-2.2.2.js"></script>
    <script src="~/signalr/hubs"></script>
    <script>
        $(function () {
            var time = $.connection.timeHub;
            var data = $.connection.dataHub;
            time.client.addNewTimeToPage = function (rollertime) {
                arr = rollertime.split("|");
                x1 = document.getElementById("time-1#");
                x1.innerHTML = arr[0];
                x2 = document.getElementById("time-2#");
                x2.innerHTML = arr[1];
                x3 = document.getElementById("time-3#");
                x3.innerHTML = arr[2];
                x4 = document.getElementById("time-4#");
                x4.innerHTML = arr[3];
                x5 = document.getElementById("time-5#");
                x5.innerHTML = arr[4];
                x6 = document.getElementById("time-6#");
                x6.innerHTML = arr[5];
                x7 = document.getElementById("time-7#");
                x7.innerHTML = arr[6];
                x8 = document.getElementById("time-8#");
                x8.innerHTML = arr[7];
                x9 = document.getElementById("time-9#");
                x9.innerHTML = arr[8];
                x10 = document.getElementById("time-10#");
                x10.innerHTML = arr[9];
                x11 = document.getElementById("time-11#");
                x11.innerHTML = arr[10];
                x12 = document.getElementById("time-12#");
                x12.innerHTML = arr[11];
            }
            data.client.addNewDataToPage = function (station, data) {
                y1 = document.getElementById("data-1#");
                y2 = document.getElementById("data-2#");
                y3 = document.getElementById("data-3#");
                y4 = document.getElementById("data-4#");
                y5 = document.getElementById("data-5#");
                y6 = document.getElementById("data-6#");
                y7 = document.getElementById("data-7#");
                y8 = document.getElementById("data-8#");
                y9 = document.getElementById("data-9#");
                y10 = document.getElementById("data-10#");
                y11 = document.getElementById("data-11#");
                y12 = document.getElementById("data-12#");

                switch (station) {
                    case "AI1-1-01": y1.innerHTML = data+"N"; break;
                    case "AI1-1-02": y2.innerHTML = data + "N"; break;
                    case "AI1-1-03": y3.innerHTML = data + "N"; break;
                    case "AI1-1-04": y4.innerHTML = data + "N"; break;
                    case "AI1-1-05": y5.innerHTML = data + "N"; break;
                    case "AI1-1-06": y6.innerHTML = data + "N"; break;
                    case "AI1-1-07": y7.innerHTML = data + "N"; break;
                    case "AI1-1-08": y8.innerHTML = data + "N"; break;
                    case "AI1-1-09": y9.innerHTML = data + "N"; break;
                    case "AI1-1-10": y10.innerHTML = data + "N"; break;
                    case "AI1-1-11": y11.innerHTML = data + "N"; break;
                    case "AI1-1-12": y12.innerHTML = data + "N"; break;

                }
            }
            $.connection.hub.start().done();


        })

    </script>



}